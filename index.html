<!DOCTYPE html>
<html>
<head>
  <title>Cannon Scene Demo</title>
  <style>
  body {
    margin: 0 auto;
    padding: 0;
    overflow: hidden;
  }
  #container {
    width: 100%;
    height: 100%;
  }
  body, html, canvas {
    width:100%;
    height:100%;
  }
  </style>
</head>
<body>
  <div id="container"></div>
  <script type="text/javascript" src="http://assets.verold.com/verold_api/verold_api_v1.unstable.js"></script>
  <script type="text/javascript">
  var extensions = [ 'https://raw.github.com/mrdoob/three.js/dev/examples/js/controls/OrbitControls.js' ];
  VAPI.initialize(extensions, function() {
    requirejs.config({
      baseUrl: '../src',
      paths: {
        cannon: 'vendor/cannon',
        underscore: 'vendor/underscore'
      },
      shim: {
        cannon: {
          exports: 'CANNON'
        }
      }
    });
    require([ 'cannon_app' ], function(CannonApp) {
      var $ = require('jquery');

      var TestApp = CannonApp.extend({
        defaultSceneLoaded: function (scene) {
          var models = scene.getAllObjects({ 'filter': { 'model': true } }),
              lookAt;

          this.model = models[Object.keys(models)[0]];

          this.camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 10000);
          this.camera.up.set(0, 1, 0);
          this.camera.position.set(0, 0.1, 2);

          lookAt = new THREE.Vector3();

          this.camera.lookAt(lookAt);

          this.veroldEngine.setActiveCamera(this.camera);

          this.controls = new THREE.OrbitControls(this.camera, $(this.el).get(0));
          this.controls.userPanSpeed = 0.1;

          /*
          scene.threeData.traverse(function(obj) {
            if (obj.isBB) {
              obj.visible = true;
            }
          });
          */
        },

        update: function(delta) {
          this.controls.update();
        }
      });

      var testApp = new TestApp({
        el: '#container',
        projectId: '518d479746685202000002fc'
      });

      testApp.run();
    });
});
</script>
</body>
</html>
